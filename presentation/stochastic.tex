\documentclass[beamer]{standalone}
\usepackage{mypackages}

\includeonlyframes{current}
\begin{document}
    \ExplSyntaxOn
        \NewDocumentCommand{\simulateRun}{ m }
        {
            \clist_map_inline:nn { #1 } { \only<+>{ \settok{ ##1 } } }
        }

        \prop_clear_new:N \l_mypkg_prop

        \NewDocumentCommand{\setProp}{ m m }
        {
            \prop_put:Nnn \l_mypkg_prop { #1 } { #2 }
        }

        \NewDocumentCommand{\getProp}{ m }
        {
            %\prop_get:NnNTF \l_mypkg_prop { #1 } \l_tmpa_tl { \tl_use:N \l_tmpa_tl } { #2 }
            \prop_item:Nn \l_mypkg_prop { #1 }
        }

        \NewDocumentCommand{\fillNode}{ m m m m }
        {
            \setProp{r1}{ #1 }
            \setProp{max}{ #2 }
            \setProp{min}{ #3 }
            \setProp{r2}{ #4 }
            \setProp{tmax}{1}
            \setProp{tmin}{0}
        }
    \ExplSyntaxOff

    \tikzset{st1/.style={fill=white},st2/.style={fill=white}}
    \newcommand{\drawStochastic}{
        \begin{tikzpicture}[node distance=1.5cm, every label/.append style={blue}]
        \node (origin) {};
        \node[rand, above=of origin, tok-here=r1, label=above:\getProp{r1},st1] (r1) {};
        \node[p1 ,left=of origin, tok-here=max, label=-5:\getProp{max}] (max) {};
        \node[p2, left=of max, tok-here=min, label=above right:\getProp{min}] (min) {};
        \node[rand, below=of origin, tok-here=r2, label=below:\getProp{r2}, st2] (r2) {};

        \node[p1, terminal, right=of r1, yshift=-1cm, tok-here=tmax, label=right:\getProp{tmax}] (tmax) {};
        \node[p2, terminal, right=of r2, yshift=1cm, tok-here=tmin, label=right:\getProp{tmin}] (tmin) {};

        \draw[every edge/.append style={post}]
            (r1) edge node[above, xshift=0.5em] {$\frac{1}{2}$} (tmax)
            (r1) edge[out=170, in=90] node[above, xshift=-0.5em] {$\frac{1}{2}$} (max)
            (max) edge[bend right] (r1)
            (max) edge (r2)
            (r2) edge node[below right] {$\frac{1}{2}$} (tmin)
            (r2) edge node[above left] {$\frac{1}{2}$} (tmax)
            (min) edge (max)
            (min) edge[bend right] (r2);
        \end{tikzpicture}
    }

    \NewDocumentCommand{\simulateVal}{ m m m m }{
        \only<+->{\fillNode{ #1 }{ #2 }{ #3 }{ #4 }}
    }

    \begin{standaloneframe}{Simple Stochastic Game}
        \splitCol{0.4}{0.55}{
        \simulateRun{min, max, r1, max, r2, tmax}
        \onslide<+>{\alert{Circle Wins}}\\
        \simulateRun{max, r2, tmin}
        \onslide<+>{\alert{Box Wins}}\\
        \only<+>{Or}
        \simulateRun{min, max, r1, max, r1, max, r1, tmax}
        \onslide<+->{Circle can win with probability 1 from \tikz \node[inner sep=0, minimum size=1ex,rectangle,draw=black] {};}
    }{ \scalebox{0.77}{\drawStochastic} }
    \end{standaloneframe}
    \colorlet{c1}{pink}
    \colorlet{c2}{lime}
    \newcommand{\mynode}[2][]{\tikz \node[inner sep=0, minimum size=1ex, draw, #2] {#1};}
    \newcommand{\tr}[1]{\mynode{triangle,fill=c#1, minimum size=2ex}}
    \newcommand{\randcolstyle}[1]{\tikzset{st#1/.style={fill=c#1}}}
    \newcommand{\setrandcolstyle}{\randcolstyle{1} \randcolstyle{2}}

    \begin{standaloneframe}[label=current]{Simple Stochastic Game}{Values}
        \SetMyToken{}
        \splitCol{0.4}{0.55}{
            \onslide<3>{
            \begin{align*}
                v(\mynode{terminal,circle}) &= 1\\
                v(\mynode{terminal,rectangle}) &= 0\\
                v(\tr{1}) &= \frac{1}{2}( v(\mynode{terminal, circle}) + v(\mynode{circle}))\\
                v(\tr{2}) &= \frac{1}{2}( v(\mynode{terminal, circle}) + v(\mynode{terminal, rectangle}) )\\
                v(\mynode{circle}) &= \max\{v(\tr{1}),v(\tr{2})\}\\
                v(\mynode{rectangle}) &= \min\{v(\mynode{circle}), v(\tr{2})\}\\
            \end{align*}
        }
        }{
        \simulateVal{1}{1}{}{$\frac{1}{2}$}
        \simulateVal{1}{1}{$\frac{1}{2}$}{$\frac{1}{2}$}
        \only<+->{\setrandcolstyle}
        \scalebox{0.77}{\drawStochastic}}
    \end{standaloneframe}
\end{document}
